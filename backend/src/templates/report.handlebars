<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Interview Report — {{candidate.name}} x {{company.name}}</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; color:#111; line-height:1.45; }
    h1,h2,h3 { margin: 0.2em 0 0.4em; }
    h1 { font-size: 26px; }
    h2 { font-size: 20px; border-bottom: 2px solid #222; padding-bottom: 4px; }
    h3 { font-size: 16px; margin-top: 16px; }
    .muted { color:#666; }
    .grid { display:grid; gap:10px; grid-template-columns: repeat(2, 1fr); }
    .grid-4 { display:grid; gap:10px; grid-template-columns: repeat(4, 1fr); }
    .card { border:1px solid #e5e5e5; border-radius:8px; padding:10px; }
    ul { margin: 0.2em 0 0.6em 1.2em; }
    table { width:100%; border-collapse:collapse; margin:6px 0 12px; }
    th, td { border:1px solid #e5e5e5; padding:6px 8px; vertical-align:top; }
    th { background:#fafafa; text-align:left; }
    .pill { display:inline-block; padding:2px 8px; border-radius:999px; background:#f2f2f2; font-size:12px; }
    .small { font-size: 12px; }
    .right { text-align:right; }
    .mt { margin-top: 12px; }
    .mb { margin-bottom: 12px; }
    .section { page-break-inside: avoid; margin-bottom: 14px; }
    .two-col { display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    a { color: #0a66c2; text-decoration: none; }
  </style>
</head>
<body>

  <!-- Header -->
  <div class="section">
    <h1>Interview Report</h1>
    <div class="muted small">
      Candidat: <strong>{{candidate.name}}</strong> • Poste: <strong>{{role.title}}</strong> • Société: <strong>{{company.name}}</strong>
      {{#if generatedAt}}• Généré le {{generatedAt}}{{/if}}
    </div>
  </div>

  <!-- Business Model -->
  {{#if company.businessModel}}
  <div class="section">
    <h2>Business model</h2>
    <div class="card">
      <p>{{company.businessModel}}</p>
      {{#if company.revenueStreams}}
        <h3>Revenue streams</h3>
        <ul>
          {{#each company.revenueStreams}}<li>{{this}}</li>{{/each}}
        </ul>
      {{/if}}
      {{#if company.pricing}}
        <h3>Pricing</h3>
        <ul>
          {{#each company.pricing}}<li>{{this}}</li>{{/each}}
        </ul>
      {{/if}}
      {{#if company.keyCustomers}}
        <h3>Key customers / segments</h3>
        <ul>
          {{#each company.keyCustomers}}<li>{{this}}</li>{{/each}}
        </ul>
      {{/if}}
    </div>
  </div>
  {{/if}}

  <!-- Strategy (ex-SWOT) -->
  {{#if strategy}}
  <div class="section">
    <h2>Strategy</h2>

    <div class="grid-4">
      <div class="card">
        <h3>Strengths</h3>
        <ul>{{#each strategy.strengths}}<li>{{this}}</li>{{/each}}</ul>
      </div>
      <div class="card">
        <h3>Weaknesses</h3>
        <ul>{{#each strategy.weaknesses}}<li>{{this}}</li>{{/each}}</ul>
      </div>
      <div class="card">
        <h3>Opportunities</h3>
        <ul>{{#each strategy.opportunities}}<li>{{this}}</li>{{/each}}</ul>
      </div>
      <div class="card">
        <h3>Threats</h3>
        <ul>{{#each strategy.threats}}<li>{{this}}</li>{{/each}}</ul>
      </div>
    </div>

    {{#if company.topNews}}
      <h3 class="mt">Top news</h3>
      <table>
        <thead>
          <tr><th>Titre</th><th>Source</th><th class="right">Date</th></tr>
        </thead>
        <tbody>
          {{#each company.topNews}}
          <tr>
            <td><a href="{{url}}">{{title}}</a>{{#if summary}}<div class="small muted">{{summary}}</div>{{/if}}</td>
            <td>{{#if source}}{{source}}{{else}}—{{/if}}</td>
            <td class="right">{{#if date}}{{date}}{{else}}—{{/if}}</td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    {{/if}}
  </div>
  {{/if}}

  <!-- Profile & Experience Matching -->
  {{#if profileMatch}}
  <div class="section">
    <h2>Profile & Experience matching</h2>
    {{#if profileMatch.matchScore}}
      <div class="mb"><span class="pill">Score global : {{profileMatch.matchScore}}%</span></div>
    {{/if}}
    {{#if profileMatch.summary}}<p class="muted">{{profileMatch.summary}}</p>{{/if}}
    <table>
      <thead>
        <tr><th>Exigence</th><th>Évidence (expérience)</th><th class="right">Score</th></tr>
      </thead>
      <tbody>
        {{#each profileMatch.items}}
          <tr>
            <td>{{requirement}}</td>
            <td>{{evidence}}</td>
            <td class="right">{{#if score}}{{score}}%{{else}}—{{/if}}</td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>
  {{/if}}

  <!-- The Why -->
  {{#if why}}
  <div class="section">
    <h2>The why</h2>
    <div class="two-col">
      <div class="card">
        <h3>Why this company?</h3>
        <ul>{{#each why.whyCompany}}<li>{{this}}</li>{{/each}}</ul>
      </div>
      <div class="card">
        <h3>Why this role?</h3>
        <ul>{{#each why.whyRole}}<li>{{this}}</li>{{/each}}</ul>
      </div>
    </div>
    <div class="card mt">
      <h3>Why you / why now?</h3>
      <ul>{{#each why.whyYou}}<li>{{this}}</li>{{/each}}</ul>
    </div>
  </div>
  {{/if}}

  <!-- Interview Q&A -->
  {{#if interview}}
  <div class="section">
    <h2>Interview questions & answers</h2>

    {{#if interview.questionsForCandidate}}
      <h3>Questions probables de l’entreprise → au candidat</h3>
      {{#each interview.questionsForCandidate}}
        <div class="card mb">
          <div><strong>Q.</strong> {{question}}</div>
          {{#if answer}}<div class="mt"><strong>A.</strong> {{answer}}</div>{{/if}}
          {{#if note}}<div class="small muted mt">{{note}}</div>{{/if}}
        </div>
      {{/each}}
    {{/if}}

    {{#if interview.questionsForCompany}}
      <h3 class="mt">Questions du candidat → à l’entreprise</h3>
      {{#each interview.questionsForCompany}}
        <div class="card mb">
          <div><strong>Q.</strong> {{question}}</div>
          {{#if note}}<div class="small muted mt">{{note}}</div>{{/if}}
        </div>
      {{/each}}
    {{/if}}

  </div>
  {{/if}}

</body>
</html>
